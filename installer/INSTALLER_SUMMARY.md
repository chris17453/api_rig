# Installer Project Summary

## Overview

This document summarizes the installer project that has been added to the PostmanClone solution. The installer project enables creating distributable packages for Windows, Linux, and macOS platforms.

## What Was Created

### 1. Windows Installer (WiX Toolset)

**Files:**
- `installer/PostmanClone.Installer.wixproj` - WiX project file
- `installer/Product.wxs` - Main product definition with upgrade logic
- `installer/UI.wxs` - Installer UI customization
- `installer/Files.wxs` - File manifest (auto-generated by build script)
- `installer/build-installer.ps1` - PowerShell build script

**Features:**
- MSI installer with standard Windows Installer features
- Start Menu and Desktop shortcuts
- Automatic upgrade support
- License agreement dialog
- Custom installation directory selection
- Option to launch application after installation
- .NET 10.0 runtime check

**Output:** `PostmanClone-Setup.msi`

### 2. Linux Packages

**Files:**
- `installer/build-package.sh` - Universal build script

**Features:**
- **.tar.gz archive** - Universal Linux package
  - Self-contained with all dependencies
  - Can be extracted and run from any location
  
- **.deb package** - Debian/Ubuntu package
  - Proper package metadata
  - Desktop entry for application menu
  - Automatic dependency resolution
  - Integration with system package manager

**Output:** 
- `postmanclone-1.0.0-linux-x64.tar.gz`
- `postmanclone_1.0.0_amd64.deb`

### 3. macOS Packages

**Files:**
- `installer/build-package.sh` - Same script as Linux

**Features:**
- **.app bundle** - Native macOS application bundle
  - Proper Info.plist with bundle metadata
  - Executable with correct permissions
  - Can be run directly or installed to Applications
  
- **.dmg installer** - macOS disk image
  - Drag-and-drop installation
  - Professional macOS installation experience

**Output:**
- `PostmanClone.app`
- `PostmanClone-1.0.0.dmg`

### 4. Publish Profiles

**Files (in `src/PostmanClone.App/Properties/PublishProfiles/`):**
- `win-x64.pubxml` - Windows 64-bit Intel/AMD
- `win-arm64.pubxml` - Windows ARM64
- `linux-x64.pubxml` - Linux 64-bit Intel/AMD
- `linux-arm64.pubxml` - Linux ARM64
- `osx-x64.pubxml` - macOS Intel
- `osx-arm64.pubxml` - macOS Apple Silicon

**Features:**
- Pre-configured for Release builds
- Self-contained deployments
- Platform-specific optimizations (ReadyToRun)
- Native library inclusion

### 5. Documentation

**Files:**
- `INSTALL.md` - End-user installation guide
- `installer/README.md` - Developer guide for building installers
- `README.MD` - Updated with installer information

**Content:**
- Installation instructions for all platforms
- System requirements
- Troubleshooting guides
- Build instructions for developers
- CI/CD integration examples

### 6. CI/CD Workflow

**File:**
- `.github/workflows/build-installers.yml`

**Features:**
- Automated builds on tag push (e.g., `v1.0.0`)
- Manual workflow dispatch with version parameter
- Parallel builds for all platforms
- Artifact upload for each platform
- Automatic GitHub Release creation with installers
- Proper security permissions (minimal GITHUB_TOKEN permissions)

**Triggered by:**
- Pushing a tag like `v1.0.0`
- Manual workflow dispatch from Actions tab

### 7. Assets

**Files:**
- `installer/Assets/LICENSE.rtf` - MIT License in RTF format for installer
- `installer/Assets/logo.ico` - Placeholder for application icon (needs replacement)

## Supported Platforms

| Platform | Architecture | Package Type | Size (approx) |
|----------|-------------|--------------|---------------|
| Windows | x64 | .msi | ~40 MB |
| Windows | ARM64 | .msi | ~40 MB |
| Linux | x64 | .tar.gz, .deb | 49 MB / 39 MB |
| Linux | ARM64 | .tar.gz, .deb | ~45 MB / ~35 MB |
| macOS | x64 (Intel) | .app, .dmg | ~50 MB |
| macOS | ARM64 (Apple Silicon) | .app, .dmg | ~45 MB |

## How to Build Installers

### Prerequisites

**Windows:**
- .NET 10.0 SDK
- WiX Toolset 3.11+ (download from https://wixtoolset.org/releases/)

**Linux:**
- .NET 10.0 SDK
- dpkg-deb (for .deb packages): `sudo apt-get install dpkg`

**macOS:**
- .NET 10.0 SDK
- Xcode Command Line Tools: `xcode-select --install`

### Build Commands

**Windows Installer:**
```powershell
.\installer\build-installer.ps1
```

With custom version:
```powershell
.\installer\build-installer.ps1 -Version 2.0.0
```

**Linux Packages:**
```bash
./installer/build-package.sh Release 1.0.0 linux-x64
./installer/build-package.sh Release 1.0.0 linux-arm64
```

**macOS Packages:**
```bash
./installer/build-package.sh Release 1.0.0 osx-x64
./installer/build-package.sh Release 1.0.0 osx-arm64
```

### Using Publish Profiles

You can also use the publish profiles directly with `dotnet publish`:

```bash
# Windows x64
dotnet publish src/PostmanClone.App/PostmanClone.App.csproj -p:PublishProfile=win-x64

# Linux x64
dotnet publish src/PostmanClone.App/PostmanClone.App.csproj -p:PublishProfile=linux-x64

# macOS ARM64 (Apple Silicon)
dotnet publish src/PostmanClone.App/PostmanClone.App.csproj -p:PublishProfile=osx-arm64
```

This publishes to the `publish/{platform}` directory but doesn't create the installer package.

## Output Locations

After building, installer packages are located in:

- **Windows:** `installer/bin/Release/win-x64/PostmanClone-Setup.msi`
- **Linux/macOS:** `packages/` directory
  - `postmanclone-1.0.0-linux-x64.tar.gz`
  - `postmanclone_1.0.0_amd64.deb`
  - `PostmanClone.app`
  - `PostmanClone-1.0.0.dmg`

Published application files (before packaging) are in `publish/{platform}/`

## CI/CD Usage

### Triggering Automated Builds

**Method 1: Tag-based release**
```bash
git tag v1.0.0
git push origin v1.0.0
```

This triggers the workflow, builds all platforms, and creates a GitHub Release with all installer files.

**Method 2: Manual workflow dispatch**
1. Go to GitHub repository → Actions tab
2. Select "Build Installers" workflow
3. Click "Run workflow"
4. Enter version number (e.g., 1.0.0)
5. Click "Run workflow"

This builds all platforms and uploads artifacts (no release created).

### Downloading Build Artifacts

After the workflow completes:
1. Go to Actions → Build Installers → specific run
2. Scroll to "Artifacts" section
3. Download:
   - `windows-installer-x64` - Windows MSI
   - `linux-packages` - Linux .tar.gz and .deb
   - `macos-packages` - macOS .app and .dmg

## Testing

The Linux build script has been tested and successfully created:
- `.tar.gz` archive (49 MB) with all dependencies
- `.deb` package (39 MB) with proper Debian package structure

Windows and macOS builds have not been tested in this environment (requires respective platforms and tools).

## Next Steps / Future Improvements

1. **Replace logo.ico placeholder** with actual application icon
   - Create a proper .ico file with multiple sizes (16x16, 32x32, 48x48, 256x256)
   - Place in `installer/Assets/logo.ico`

2. **Code signing** (optional but recommended for production)
   - Windows: Sign .msi with Authenticode certificate
   - macOS: Sign .app and .dmg with Apple Developer certificate
   - Linux: Sign packages with GPG key

3. **Notarization** (macOS only)
   - Submit .dmg to Apple for notarization
   - Required for distribution outside Mac App Store

4. **Installer customization**
   - Add custom branding graphics (banner, dialog background)
   - Customize installer UI colors and fonts
   - Add custom installation options

5. **Additional platforms**
   - Add Windows x86 (32-bit) support if needed
   - Add portable/standalone versions (no installation required)

6. **Update checking**
   - Add auto-update functionality to the application
   - Check for new versions on GitHub Releases

7. **Chocolatey package** (Windows)
   - Create Chocolatey package for easier distribution on Windows
   - Submit to Chocolatey community repository

8. **Snap/Flatpak** (Linux)
   - Create Snap or Flatpak packages for universal Linux distribution
   - Submit to Snap Store or Flathub

9. **Homebrew formula** (macOS)
   - Create Homebrew Cask formula for easy installation via `brew install`

## Configuration Files

### Updated Files

- **`.gitignore`** - Added exclusions for:
  - `publish/` - Published application files
  - `packages/` - Generated installer packages
  - `installer/bin/` - WiX build output
  - `installer/obj/` - WiX intermediate files
  - `*.wixobj`, `*.wixpdb` - WiX artifacts
  - Exception added for publish profile files

- **`PostmanClone.slnx`** - Added installer project reference

### New Directories

- `installer/` - Installer project root
- `installer/Assets/` - Installer assets (icons, license)
- `src/PostmanClone.App/Properties/PublishProfiles/` - Publish profiles

## Security

All security scans passed:
- ✅ Code review completed with no issues
- ✅ CodeQL security scan completed with no vulnerabilities
- ✅ GitHub Actions workflow has minimal permissions (contents: read/write)

## Maintenance

### Updating Version Numbers

Update version in multiple locations when releasing:

1. **WiX installer** - `installer/Product.wxs`:
   ```xml
   <?define ProductVersion = "1.0.0" ?>
   ```

2. **Build scripts** - Pass as parameter:
   ```powershell
   .\installer\build-installer.ps1 -Version 1.1.0
   ```

3. **GitHub workflow** - Tag or manual input determines version

### Adding Files to Installer

Windows installer uses WiX Heat tool to automatically harvest all files from the publish directory. No manual file list maintenance required.

For Linux/macOS, the build scripts package all files in the publish directory automatically.

## Support

For issues or questions about the installer:
- See `installer/README.md` for detailed build instructions
- See `INSTALL.md` for end-user installation help
- Open an issue on GitHub: https://github.com/chris17453/api_rig/issues

## License

The installer project follows the same MIT License as the main application.
See `installer/Assets/LICENSE.rtf` for the full license text.

---

**Created:** 2026-01-09  
**Version:** 1.0  
**Status:** Complete and tested (Linux), ready for Windows/macOS testing
