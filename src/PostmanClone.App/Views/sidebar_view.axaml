<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:PostmanClone.App.ViewModels"
             mc:Ignorable="d" d:DesignWidth="250" d:DesignHeight="600"
             x:Class="PostmanClone.App.Views.sidebar_view"
             x:DataType="vm:sidebar_view_model">

    <Grid RowDefinitions="Auto,*,Auto,*" Background="#161B22">
        <!-- Collections Header -->
        <Border Grid.Row="0" Padding="16,12">
            <StackPanel Orientation="Horizontal" Spacing="8">
                <TextBlock Text="ðŸ“" FontSize="14"/>
                <TextBlock Text="Collections" 
                           FontWeight="SemiBold" 
                           FontSize="13"
                           Foreground="#F0F6FC"/>
            </StackPanel>
        </Border>
        
        <!-- Collections Tree -->
        <TreeView Grid.Row="1" 
                  ItemsSource="{Binding Collections}"
                  SelectedItem="{Binding SelectedCollectionItem}"
                  Background="Transparent"
                  Margin="8,0">
            <TreeView.Styles>
                <Style Selector="TreeViewItem">
                    <Setter Property="Padding" Value="8,6"/>
                </Style>
            </TreeView.Styles>
            <TreeView.ItemTemplate>
                <TreeDataTemplate ItemsSource="{Binding Children}">
                    <Border Background="Transparent" 
                            CornerRadius="6" 
                            Padding="8,6">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock Text="ðŸ“" IsVisible="{Binding IsFolder}" FontSize="12"/>
                            <TextBlock Text="ðŸ“„" IsVisible="{Binding !IsFolder}" FontSize="12"/>
                            <Border Background="#238636" 
                                    CornerRadius="4" 
                                    Padding="6,2"
                                    IsVisible="{Binding Method, Converter={x:Static ObjectConverters.IsNotNull}}">
                                <TextBlock Text="{Binding Method}" 
                                           FontWeight="Bold"
                                           FontSize="9"
                                           Foreground="#FFFFFF"/>
                            </Border>
                            <TextBlock Text="{Binding Name}" 
                                       Foreground="#C9D1D9"
                                       FontSize="12"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </TreeDataTemplate>
            </TreeView.ItemTemplate>
        </TreeView>

        <!-- History Header -->
        <Border Grid.Row="2" 
                Padding="16,12"
                BorderBrush="#21262D"
                BorderThickness="0,1,0,0">
            <StackPanel Orientation="Horizontal" Spacing="8">
                <TextBlock Text="ðŸ•" FontSize="14"/>
                <TextBlock Text="History" 
                           FontWeight="SemiBold" 
                           FontSize="13"
                           Foreground="#F0F6FC"/>
            </StackPanel>
        </Border>
        
        <!-- History List -->
        <ListBox Grid.Row="3" 
                 ItemsSource="{Binding History}"
                 SelectedItem="{Binding SelectedHistoryItem}"
                 Background="Transparent"
                 Margin="8,0,8,8">
            <ListBox.Styles>
                <Style Selector="ListBoxItem">
                    <Setter Property="Padding" Value="0"/>
                    <Setter Property="Margin" Value="0,0,0,4"/>
                </Style>
                <Style Selector="ListBoxItem:selected /template/ ContentPresenter">
                    <Setter Property="Background" Value="#21262D"/>
                </Style>
            </ListBox.Styles>
            <ListBox.ItemTemplate>
                <DataTemplate x:DataType="vm:history_item_view_model">
                    <Border Background="#0D1117" 
                            CornerRadius="8" 
                            Padding="12,10"
                            BorderBrush="#21262D"
                            BorderThickness="1">
                        <Grid RowDefinitions="Auto,Auto,Auto">
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="8">
                                <Border Background="#238636" 
                                        CornerRadius="4" 
                                        Padding="6,2">
                                    <TextBlock Text="{Binding Method}" 
                                               FontWeight="Bold"
                                               FontSize="9"
                                               Foreground="#FFFFFF"/>
                                </Border>
                                <Border Background="#1F6FEB" 
                                        CornerRadius="4" 
                                        Padding="6,2">
                                    <TextBlock Text="{Binding StatusCode}" 
                                               FontSize="9"
                                               FontWeight="SemiBold"
                                               Foreground="#FFFFFF"/>
                                </Border>
                            </StackPanel>
                            <TextBlock Grid.Row="1" 
                                       Text="{Binding Url}" 
                                       FontSize="11"
                                       TextTrimming="CharacterEllipsis"
                                       Foreground="#8B949E"
                                       Margin="0,6,0,4"
                                       FontFamily="JetBrains Mono, Consolas, monospace"/>
                            <TextBlock Grid.Row="2"
                                       Text="{Binding ExecutedAt, StringFormat={}{0:g}}" 
                                       FontSize="10"
                                       Foreground="#484F58"/>
                        </Grid>
                    </Border>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</UserControl>
